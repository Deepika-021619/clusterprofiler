library(limma)

# Expression data
expr <- read.table("expression_matrix.txt", header = TRUE, row.names = 1)

# Sample group information
group <- factor(c("Control","Control","Disease","Disease"))

design <- model.matrix(~group)
fit <- lmFit(expr, design)
fit <- eBayes(fit)

# Extract top 50 DE genes
top50 <- topTable(fit, number = 50)
write.csv(top50, "top50_DEGs.csv")

Hierarchical Clustering

heatmap(as.matrix(expr[rownames(top50), ]),
        scale = "row",
        col = colorRampPalette(c("blue","white","red"))(100))

K-Means Clustering

set.seed(123)
kmeans_res <- kmeans(expr[rownames(top50), ], centers = 4)

plot(prcomp(expr[rownames(top50), ])$x,
     col = kmeans_res$cluster,
     pch = 16,
     main = "K-means Clustering of Top 50 DE Genes")
